<div class="row">
    <div class="col-md-3">
        <img class="img-fluid img-rounded d-none d-sm-block" src="https://crossingzebras.com/wp-content/uploads/2015/04/catch_Join.png"></img>
    </div>
    <div class="col-md-9">

        <!-- Modal -->
        <div class="modal fade" id="criteriaModal" tabindex="-1" role="dialog" aria-labelledby="criteriaModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="criteriaModalLabel">Killmail Criterias</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        To get BraveBucks, your killmail must not be from a fleet fight (max. 20 attackers), not an awox and in one of the circled systems on the right. Empty pods are not counted. Check Hunting Area for the systems that we track.
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal -->
        <div class="modal fade" id="calcModal" tabindex="-1" role="dialog" aria-labelledby="calcModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="calcModalLabel">Bucks Calculation</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        BraveBucks are based on a monthly budget, which currently for example is 5 bil. Every day of the month gets the same share (~160mil in that case). Every day during downtime we do two things: First we take all the kills that were tracked and do some points calculation (see below) so that every player ends up with a number of points for that day (may be 0 if you didn't get on any legitimate killmails, we will soon show the points for each killmail on the recent defense kills section). Secondly we spread the isk for that day over the points that were gathered that day. So if one player got 60 points, and one other player 40, they will get 90 and 64 mil each. That ISK is added to your bar during DT. Once you reach 100mil isk, you can request a payout.
                        <br/>
                        Points calculation is super simple: <i>sqrt(zKillPoints * (6 - ADM))</i>
                        <br/>
                        <ul>
                            <li>sqrt to keep the points balanced, many killmails only have one point, some have 50</li>
                            <li>6 - ADM: systems with an ADM of 6 are not rewarded, from there the lower the better</li>
                        </ul>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal -->
        <div class="modal fade" id="huntModal" tabindex="-1" role="dialog" aria-labelledby="huntModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="huntModalLabel">Hunting Area</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        Maps (hunting systems are circled black):
                        <ul>
                            <li>
                                <a target="_blank" href="{{getDotlanLink('Catch')}}">Catch</a>
                            </li>
                        </ul>
                        List of systems:
                        <ul>
                            <li *ngFor="let system of systems">{{system.systemName}}</li>
                        </ul>
                        Feel free to request more systems on the <a target="_blank" href="https://forums.bravecollective.com/viewtopic.php?f=34&t=4195">forums</a>.
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <h1 class="display-4">Welcome, Braveling!</h1>

        <div *ngIf="!isAuthenticated()">
            <div class="row">
                <div class="col-md-6">
                    <div class="card mb-3">
                        <img class="card-img-top" src="../../content/images/intro1.png" width="50%">
                        <div class="card-body">
                            <h4 class="card-title">1. Log In with EvE SSO</h4>
                            <p class="card-text">Only authenticate, no scopes required. Your tracking starts!</p>
                            <p class="card-text"><small class="text-muted">Select your main character.</small></p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card mb-3">
                        <img class="card-img-top" src="../../content/images/intro2.png" >
                        <div class="card-body">
                            <h4 class="card-title">2. Shoot Enemies</h4>
                            <p class="card-text">Undock and defend our space. You will see which systems are
                            tracked after you log in.</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="card mb-3">
                        <img class="card-img-top" src="../../content/images/intro3.png" width="50%" >
                        <div class="card-body">
                            <h4 class="card-title">3. Collect Killmails</h4>
                            <p class="card-text">Tackle, ewar, deeps or plain whoring. Do what you can do best!</p>
                            <p class="card-text"><small class="text-muted">Disclaimer: Fleet kills (>20 attackers) don't count.</small></p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card mb-3">
                        <img class="card-img-top" src="../../content/images/intro4.png">
                        <div class="card-body">
                            <h4 class="card-title">4. Race for the Payout</h4>
                            <p class="card-text">Check in to see your potential payout as you can closer and closer to that sweeeet ISK.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div *ngIf="isAuthenticated()">
            <div *ngIf="isFirstLogin" class="alert alert-success">
                <div class="row">
                    <div class="col-md-10">
                        You have been added to the tracker that will pull from <a target="_blank" href="https://zkillboard.com">zkillboard</a> every 10 minutes.
                    </div>
                    <div class="col-md-2">
                        <button class="btn btn-success" (click)="setFirstLogin()">Got it!</button>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <p>We want <b>you</b> to make our space safer. Help the industry grow and the ratters raise the war chest by doing what you do best: <b>Shooting enemies!</b></p>
                    <p>We believe encouraging fast local PvP responses can protect our space by protecting ratters and miners who again raise our ADMs. This again makes our space easier
                       to defend with the current sovereignty system.</p>
                    </div>
                <div class="col-md-6">
                    <p>Once you logged in, this website will track your PvP activity from <a target="_blank" href="https://zkillboard.com">zkillboard</a>. Based on this data we give you points for brave defenses,
                       last hits and all the things that boost fast local responses. Every day during downtime, we transfer the points to ISK. Once you reach 100mil ISK, you can request a payout.</p>
                    Maps (hunting systems are circled black):
                    <ul>
                        <li>
                            <a target="_blank" href="{{getDotlanLink('Catch')}}">Catch</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#criteriaModal">
                        Killmail Criterias
                    </button>
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#calcModal">
                        Bucks Calculation
                    </button>
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#huntModal">
                        Hunting Area
                    </button>
                </div>
            </div>
            <br/>
            <div class="row" *ngIf="ad">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            Sponsored
                            <a href="#" routerLink="request-ad" class="pull-right">Request Your Ad</a>
                        </div>
                        <div class="card-body">
                            <h4 class="card-title">{{ad.service}}</h4>
                            <p class="card-text">{{ad.description}}</p>
                            <a *ngIf="ad.link" href="{{ad.link}}" class="btn btn-primary" target="_blank">Visit</a>
                        </div>
                    </div>
                </div>
            </div>
            <br *ngIf="ad"/>
            <div class="row">
                <div class="col-md-12">
                    <h3>Payouts</h3>
                    <span *ngIf="monthAvailable">Available this month: {{monthAvailable | number:'1.0-0'}} ISK. Killmails are converted to ISK during downtime.</span>
                    <div *ngIf="payoutRequested" class="alert alert-success">Payout requested!</div>
                    <div class="input-group">
                        <div class="progress" style="width: 100%;">
                            <div class="progress-bar progress-bar-striped bg-success" role="progressbar" style="height: 40px" [style.width]="getBarWidth(potentialPayout)+'%'">
                                <div *ngIf="potentialPayout >= payoutThreshold / 2" style="height: 40px; line-height: 2.5rem; font-size: 1.5rem">Your payout: {{potentialPayout | number:'1.0-0'}} ISK</div>
                            </div>
                            <span *ngIf="potentialPayout < payoutThreshold / 2" style="height: 40px; line-height: 2.5rem; font-size: 1.5rem; padding-left: 10px">Your payout: {{potentialPayout | number:'1.0-0'}} ISK</span>
                        </div>
                        <button *ngIf="potentialPayout >= payoutThreshold" class="btn btn-primary" (click)="requestPayout()">Request Payout</button>
                    </div>
                    <p *ngIf="potentialPayout < payoutThreshold" style="text-align: center">{{payoutThreshold - potentialPayout | number:'1.0-0'}} ISK until you can request a payout</p>
                    <br/>
                </div>
            </div>
            <!--<div class="row">-->
                <!--<div *ngIf="pools" class="col-md-6">-->
                    <!--<h4>Hunter Pool</h4>-->
                    <!--<table class="table table-condensed table-striped table-bordered">-->
                        <!--<tr>-->
                            <!--<td width="50%">Next Month (WIP)</td>-->
                            <!--<td>{{pools[0] | number:'1.0-0'}} ISK</td>-->
                        <!--</tr>-->
                        <!--<tr>-->
                            <!--<td><b>This Month</b></td>-->
                            <!--<td>{{pools[1] | number:'1.0-0'}} ISK</td>-->
                        <!--</tr>-->
                        <!--<tr>-->
                            <!--<td>Last Month</td>-->
                            <!--<td>{{pools[2] | number:'1.0-0'}} ISK</td>-->
                        <!--</tr>-->
                    <!--</table>-->
                <!--</div>-->
                <!--<div *ngIf="myStats" class="col-md-6">-->
                    <!--<h4>Your Stats</h4>-->
                    <!--<table class="table table-condensed table-striped">-->
                        <!--<tr>-->
                            <!--<td width="50%">BraveBucks Today</td>-->
                            <!--<td>{{myStats['coins']}}</td>-->
                        <!--</tr>-->
                        <!--<tr>-->
                            <!--<td>Defense Kills</td>-->
                            <!--<td>{{myStats['defenseKills']}}</td>-->
                        <!--</tr>-->
                        <!--<tr>-->
                            <!--<td>Final Blows</td>-->
                            <!--<td>{{myStats['finalBlows']}}</td>-->
                        <!--</tr>-->
                    <!--</table>-->
                <!--</div>-->
            <!--</div>-->
            <!--<div class="row">-->
                <!--<div class="col-md-6">-->
                    <!--<div class="alert alert-warning">-->
                        <!--We need your help! If you like our work and the space we live in, please consider donating-->
                        <!--to encourage more local PvP and content. DM Rihan Shazih on Slack.-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="col-md-6" style="color: lightgrey">-->
                    <!--<h4>Recent Payouts</h4>-->
                    <!--<table class="table table-condensed table-striped">-->
                        <!--<tr>-->
                            <!--<td width="50%">11.05.2017</td>-->
                            <!--<td>127,148,217 ISK</td>-->
                        <!--</tr>-->
                        <!--<tr>-->
                            <!--<td>28.04.2017</td>-->
                            <!--<td>12,845,184 ISK</td>-->
                        <!--</tr>-->
                        <!--<tr>-->
                            <!--<td>10.04.2017</td>-->
                            <!--<td>8,283,453 ISK</td>-->
                        <!--</tr>-->
                    <!--</table>-->
                <!--</div>-->
            <!--</div>-->
            <div class="row">
                <div class="col-md-6">
                    <h3>Your Recent Defense Kills</h3>
                </div>
                <div class="col-md-6">
                    <div class="input-group">
                        <input #killmailLink type="text" class="form-control" placeholder="Add a zkillboard.com link ..." aria-label="Add a zkillboard.com link..."
                                pattern="https://zkillboard.com/kill/[0-9]+/">
                        <span class="input-group-btn">
                        <button class="btn btn-secondary" type="button" (click)="submitKillmail(killmailLink.value)">Add!</button>
                    </span>
                    </div>
                    <div class="alert alert-success" *ngIf="killmailAddedManually">Killmail added! {{killmailAddedText}}</div>
                    <div class="alert alert-warning" *ngIf="killmailAlreadyExists">This killmail already exists. Please refresh your browser!</div>
                    <div class="alert alert-danger" *ngIf="killmailFailedMessage">{{killmailFailedMessage}}</div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="alert alert-info" *ngIf="!killmails || !killmails.length">
                        Undock and hunt to get your first kills! Be in standing fleet and mumble to find targets.
                    </div>
                    <table class="table table-condensed table-striped" *ngIf="killmails && killmails.length">
                        <tr>
                           <th>Killmail</th>
                           <th>Kill Time</th>
                           <th>Victim Alliance</th>
                        </tr>
                        <tr *ngFor="let killmail of killmails">
                            <td><a target="_blank" href="https://zkillboard.com/kill/{{killmail.killmailId}}"><img src="https://image.eveonline.com/Type/{{killmail.shipTypeId}}_32.png" /><span class="d-none d-sm-inline-block"> {{killmail.killmailId}}</span></a></td>
                            <td>{{killmail.killTime | date:'dd.MM.yy HH:mm'}}</td>
                            <td>{{killmail.victimAlliance}}</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
